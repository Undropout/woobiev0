<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tier 2: Let's communicate a little </title>
  <p>Now you get to send your partner a direct message <i>and/or</i> an image <i>and/or</i> a recorded message </p>
  <style>
    .image-adjust-layout {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    .has-image .image-adjust-layout {
      flex-direction: row;
      align-items: flex-start;
      flex-wrap: nowrap;
      gap: 2rem;
    }

    .image-preview-block {
      flex: 1 1 40%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .image-controls-block {
      flex: 1 1 50%;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .has-image #color-buttons {
      flex-direction: row !important;
      flex-wrap: wrap;
      justify-content: center;
    }

    /* Woobiecore file input styling */
    #image-upload {
      background-color: black !important;
      border: 2px solid #33ff33 !important;
      color: #33ff33 !important;
      padding: 0.5rem 1rem !important;
      border-radius: 5px !important;
      font-family: 'Atkinson Hyperlegible', monospace !important;
      cursor: pointer !important;
      transition: all 0.3s !important;
      display: block !important;
      width: auto !important;
      margin: 1rem auto !important;
    }

    #image-upload:hover {
      background-color: #33ff33 !important;
      color: black !important;
      box-shadow: 0 0 10px #33ff33 !important;
    }

    #image-upload::file-selector-button {
      background-color: #111111;
      border: 1px solid #33ff33;
      color: #33ff33;
      padding: 0.3rem 0.8rem;
      border-radius: 3px;
      margin-right: 0.5rem;
      font-family: 'Atkinson Hyperlegible', monospace;
      cursor: pointer;
      transition: all 0.3s;
    }

    #image-upload::file-selector-button:hover {
      background-color: #33ff33;
      color: black;
    }

    /* Woobiecore range slider styling */
    input[type="range"] {
      appearance: none !important;
      background: transparent !important;
      cursor: pointer !important;
      width: 100% !important;
      height: 6px !important;
      border-radius: 3px !important;
      background: linear-gradient(to right, #111111 0%, #33ff33 50%, #00ffff 100%) !important;
      border: 1px solid #33ff33 !important;
    }

    input[type="range"]::-webkit-slider-thumb {
      appearance: none !important;
      background: #33ff33 !important;
      height: 20px !important;
      width: 20px !important;
      border-radius: 50% !important;
      border: 2px solid #00ffff !important;
      cursor: pointer !important;
      box-shadow: 0 0 5px #33ff33 !important;
    }

    input[type="range"]::-moz-range-thumb {
      background: #33ff33 !important;
      height: 20px !important;
      width: 20px !important;
      border-radius: 50% !important;
      border: 2px solid #00ffff !important;
      cursor: pointer !important;
      box-shadow: 0 0 5px #33ff33 !important;
    }

    /* Woobiecore recording button styling */
    #start-recording, #stop-recording, #play-audio, #reset-audio {
      background-color: black !important;
      border: 2px solid #33ff33 !important;
      color: #33ff33 !important;
      padding: 0.5rem 1rem !important;
      margin: 0.25rem !important;
      border-radius: 5px !important;
      font-family: 'Atkinson Hyperlegible', monospace !important;
      cursor: pointer !important;
      transition: all 0.3s !important;
      font-size: 0.9rem !important;
    }

    #start-recording:hover, #play-audio:hover {
      background-color: #33ff33 !important;
      color: black !important;
      box-shadow: 0 0 8px #33ff33 !important;
    }

    #stop-recording:hover {
      background-color: #ff6666 !important;
      color: black !important;
      border-color: #ff6666 !important;
      box-shadow: 0 0 8px #ff6666 !important;
    }

    #reset-audio:hover {
      background-color: #ffb000 !important;
      color: black !important;
      border-color: #ffb000 !important;
      box-shadow: 0 0 8px #ffb000 !important;
    }

    #start-recording:disabled, #stop-recording:disabled, #play-audio:disabled, #reset-audio:disabled {
      opacity: 0.4 !important;
      cursor: not-allowed !important;
      border-color: #666666 !important;
      color: #666666 !important;
    }

    /* Recording indicator styling */
    #recording-indicator {
      color: #ff3333 !important;
      text-shadow: 0 0 5px #ff3333 !important;
      animation: recordingPulse 1s ease-in-out infinite alternate !important;
      font-family: 'Atkinson Hyperlegible', monospace !important;
    }

    @keyframes recordingPulse {
      from { opacity: 0.6; }
      to { opacity: 1; }
    }

    /* Audio controls styling - woobiecore theme */
    #audio-preview {
      background-color: #111111 !important;
      border: 2px solid #33ff33 !important;
      border-radius: 5px !important;
      width: 100% !important;
      margin-top: 0.5rem !important;
      height: 50px !important;
      outline: none !important;
    }

    /* Custom audio player styling */
    #audio-preview::-webkit-media-controls-panel {
      background-color: #111111 !important;
      border: none !important;
    }

    #audio-preview::-webkit-media-controls-play-button,
    #audio-preview::-webkit-media-controls-pause-button {
      background-color: #33ff33 !important;
      border-radius: 50% !important;
      border: 1px solid #00ffff !important;
      width: 35px !important;
      height: 35px !important;
      margin: 5px !important;
    }

    #audio-preview::-webkit-media-controls-timeline {
      background-color: #222222 !important;
      border-radius: 25px !important;
      margin: 0 10px !important;
      border: 1px solid #33ff33 !important;
    }

    #audio-preview::-webkit-media-controls-time-remaining-display,
    #audio-preview::-webkit-media-controls-current-time-display {
      color: #33ff33 !important;
      font-family: 'Atkinson Hyperlegible', monospace !important;
      font-size: 12px !important;
      text-shadow: 0 0 3px #33ff33 !important;
    }

    #audio-preview::-webkit-media-controls-volume-slider {
      background-color: #222222 !important;
      border: 1px solid #33ff33 !important;
      border-radius: 25px !important;
    }

    #audio-preview::-webkit-media-controls-mute-button {
      background-color: #33ff33 !important;
      border-radius: 3px !important;
      border: 1px solid #00ffff !important;
    }

    /* Alternative: Custom audio controls wrapper for non-webkit browsers */
    .audio-wrapper {
      background-color: #111111;
      border: 2px solid #33ff33;
      border-radius: 5px;
      padding: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 0.5rem;
      box-shadow: 0 0 5px rgba(51, 255, 51, 0.3);
    }

    .audio-wrapper button {
      background-color: #33ff33 !important;
      color: black !important;
      border: 1px solid #00ffff !important;
      border-radius: 50% !important;
      width: 35px !important;
      height: 35px !important;
      cursor: pointer !important;
      font-family: 'Atkinson Hyperlegible', monospace !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }

    .audio-wrapper .time-display {
      color: #33ff33;
      font-family: 'Atkinson Hyperlegible', monospace;
      font-size: 12px;
      text-shadow: 0 0 3px #33ff33;
      min-width: 40px;
    }

    .audio-wrapper .progress-bar {
      flex: 1;
      height: 6px;
      background-color: #222222;
      border: 1px solid #33ff33;
      border-radius: 25px;
      position: relative;
      cursor: pointer;
    }

    .audio-wrapper .progress-fill {
      height: 100%;
      background: linear-gradient(to right, #33ff33, #00ffff);
      border-radius: 25px;
      transition: width 0.1s;
    }

    @media (max-width: 768px) {
      .image-adjust-layout {
        flex-direction: column !important;
      }

      .has-image .image-adjust-layout {
        flex-direction: column !important;
      }

      .has-image #color-buttons {
        flex-direction: row !important;
        justify-content: center;
      }

      .image-controls-block label {
        display: block;
        text-align: center;
      }

      .image-controls-block {
        flex-direction: column;
        align-items: center;
        gap: 1rem;
      }
    }
  </style>
  <script type="module" crossorigin src="/assets/tier2Send-CB7JAlrK.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/firebase-config-C0024qU1.js">
  <link rel="modulepreload" crossorigin href="/assets/logout-q5yztgx1.js">
  <link rel="stylesheet" crossorigin href="/assets/style-DdkmcSxD.css">
</head>
<body>
  <div class="container">
    <h1>üéÅ Share Your Tier 2 Reward</h1>
    <p>You've completed Tier 2! Now you can send your match a small reward ‚Äî a note, a sketch, or a voice message.</p>

    <button id="logout-button" class="woobie-button" style="float:right;">üö™ Log out</button>

    <div id="reward-area">
      <label for="reward-text">Text Message (optional)</label>
      <textarea id="reward-text" rows="4" placeholder="Write something nice..."></textarea>

      <h3>üé® Image Reward</h3>
      <input type="file" id="image-upload" accept="image/*">

      <div class="image-adjust-layout" id="image-adjust-wrap">
        <div class="image-preview-block">
          <canvas id="chat-preview-canvas" width="128" height="128" style="border:1px solid #33ff33;"></canvas>
          <div id="color-buttons" style="display:flex; flex-direction:column; gap:0.5rem; margin-top:1rem;">
            <button class="color-btn" data-color="#33ff33" style="background:#33ff33;"></button>
            <button class="color-btn" data-color="#00ffff" style="background:#00ffff;"></button>
            <button class="color-btn" data-color="#ffb000" style="background:#ffb000;"></button>
            <button class="color-btn" data-color="#ff66ff" style="background:#ff66ff;"></button>
          </div>
        </div>

        <div class="image-controls-block">
          <label for="chat-contrast" style="color:#33ff33">Contrast</label>
          <input type="range" id="chat-contrast" min="-100" max="100" value="0" />

          <label for="output-black" style="color:#33ff33">Black Level</label>
          <input type="range" id="output-black" min="0" max="254" value="0" />

          <label for="output-white" style="color:#33ff33">White Level</label>
          <input type="range" id="output-white" min="1" max="255" value="255" />

          <label for="chat-image-alt" style="color:#33ff33; display:block; margin-top:1rem;">Alt text (140 characters):</label>
          <input type="text" id="chat-image-alt" maxlength="140" style="width:100%; margin-bottom:1rem;" />

          <div style="display:flex; justify-content:space-between; margin-top:1rem;">
            <button id="chat-cancel-upload" class="close-adjust" style="background:#222; color:#ff3333; padding:0.5rem 1rem; border:1px solid #ff3333;">Cancel</button>
            <button id="chat-send-upload" style="background:#000; color:#33ff33; padding:0.5rem 1rem; border:1px solid #33ff33;">Send Image ‚Üí</button>
          </div>
        </div>
      </div>

      <h3>üé§ Audio Message</h3>
      <div>
        <button id="start-recording">Start Recording</button>
        <button id="stop-recording" disabled>Stop</button>
        <button id="play-audio" disabled>Play</button>
        <button id="reset-audio" disabled>Reset</button>
        <span id="recording-indicator" style="display:none; color:#ff6666;">‚óè Recording</span>
      </div>
      <audio id="audio-preview" controls style="display:none;"></audio>

      <p id="status-msg" style="margin-top:1rem;"></p>
      <button id="submit-reward" class="woobie-button" style="margin-top:1rem;">‚úÖ Finalize & Send All</button>
    </div>

    <!-- Our Story Modal -->
    <div id="our-story-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:black; overflow:auto; z-index:9999; padding:2rem;">
      <button id="close-story" class="woobie-button" style="position:absolute; top:1rem; right:1rem;">‚ùå Close</button>
      <h2 style="color:#33ff33">üìö Our Story So Far</h2>
      <div id="story-content"></div>
    </div>

    <div style="margin-top: 2rem; text-align:center;">
      <button id="our-story-button" class="woobie-button">üìñ Our Story So Far</button>
    </div>
  </div>

</body>
</html>
import{s as L,a as v,o as I,r as w,d as C,g as M}from"./firebase-config-DqIMhm9h.js";/* empty css              */const b=["friends@woobie.fun"];let i=[];const r=document.getElementById("auth-check"),k=document.getElementById("admin-content"),l=document.getElementById("matches-list"),d=document.getElementById("chat-viewer"),h=document.getElementById("chat-messages"),j=document.getElementById("chat-title"),g=document.getElementById("search-input"),f=document.getElementById("logout-button");f&&(f.onclick=async()=>{await L(v),window.location.href="/auth/login.html"});I(v,async e=>{if(!e){r.textContent="Not authenticated. Redirecting to login...",setTimeout(()=>window.location.href="/auth/login.html",2e3);return}if(!b.includes(e.email)){r.textContent="Access denied. Only administrators can access this page.",r.style.color="#ff3333";return}r.style.display="none",k.style.display="block",B()});async function B(){try{const e=w(C,"matches"),t=await M(e);if(!t.exists()){l.innerHTML='<p class="no-chat">No matches found.</p>';return}const c=t.val();i=Object.entries(c).map(([s,n])=>({matchId:s,...n})),document.getElementById("total-matches").textContent=i.length;let a=0,o=0;i.forEach(s=>{if(s.chat){const n=Object.keys(s.chat).length;a+=n,n>0&&o++}}),document.getElementById("total-messages").textContent=a,document.getElementById("active-chats").textContent=o,u(i)}catch(e){console.error("Error loading matches:",e),l.innerHTML='<p style="color:#ff3333;">Error loading matches.</p>'}}function u(e){if(e.length===0){l.innerHTML='<p class="no-chat">No matches found.</p>';return}l.innerHTML=e.map(t=>{const c=t.users?Object.values(t.users).join(" & "):"Unknown users",a=t.chat?Object.keys(t.chat).length:0,o=y(t);return`
          <div class="match-item" data-match-id="${t.matchId}">
            <div class="match-info">
              <div>
                <div class="match-users">${c}</div>
                <div class="match-stage">Match ID: ${t.matchId}</div>
                <div class="match-stage">Stage: ${o} | Messages: ${a}</div>
              </div>
            </div>
          </div>
        `}).join(""),document.querySelectorAll(".match-item").forEach(t=>{t.addEventListener("click",()=>{const c=t.dataset.matchId;$(c)})})}function y(e){return e.chat&&Object.keys(e.chat).length>0?"chatroom":e.tier3?"tier3":e.tier2?"tier2":e.tier1b?"tier1b":e.tier1a?"tier1a":e.bios?"bio":"created"}function $(e){document.querySelectorAll(".match-item").forEach(s=>{s.classList.toggle("selected",s.dataset.matchId===e)});const t=i.find(s=>s.matchId===e);if(!t)return;const c=t.users?Object.values(t.users).join(" & "):"Unknown users";if(j.textContent=`Chat: ${c} (${e})`,!t.chat||Object.keys(t.chat).length===0){h.innerHTML='<p class="no-chat">No messages in this chat yet.</p>',d.classList.add("active");return}const a=Object.entries(t.chat).map(([s,n])=>({msgId:s,...n}));a.sort((s,n)=>(s.timestamp||0)-(n.timestamp||0));const o=["slur","nigger","nigga","faggot","retard","kys","kill yourself"];h.innerHTML=a.map(s=>{const n=s.text||"",m=o.some(E=>n.toLowerCase().includes(E.toLowerCase())),p=s.timestamp?new Date(s.timestamp).toLocaleString():"Unknown time";return`
          <div class="chat-message ${m?"flagged":""}">
            <div class="chat-sender">${s.sender||"Unknown"}</div>
            <div class="chat-text">${x(n)}</div>
            <div class="chat-timestamp">${p}${m?" ⚠️ FLAGGED":""}</div>
          </div>
        `}).join(""),d.classList.add("active"),d.scrollTop=0}function x(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}g&&g.addEventListener("input",e=>{const t=e.target.value.toLowerCase().trim();if(!t){u(i);return}const c=i.filter(a=>{const o=a.matchId.toLowerCase(),s=a.users?Object.values(a.users).join(" ").toLowerCase():"",n=y(a).toLowerCase();return o.includes(t)||s.includes(t)||n.includes(t)});u(c)});

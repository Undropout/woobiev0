import{o as ye,g as te,r as B,d as E,a as he,b as ne,u as z}from"./firebase-config-DqIMhm9h.js";/* empty css              */import"./logout-C5vuDOMp.js";const w=["Vibrant","Lazy","Cheerful","Quirky","Gentle","Bold","Shy","Clever"],re=["Radiant","Shimmering","Iridescent","Gleaming","Prismatic"],le=["Glowing","Electric","Buzzing","Pulsing","Flashing"],ae=["Stellar","Astral","Luminous","Celestial","Galactic"],D=["Amber","Amaranth","Amethyst","Apricot","Aqua","Aquamarine","Auburn","Azure","Beige","Black","Blue","Bronze","Brown","Cardinal","Carmine","Celadon","Cerise","Cerulean","Charcoal","Chartreuse","Chocolate","Cinnamon","Copper","Coquelicot","Coral","Cream","Crimson","Cyan","Denim","Ebony","Ecru","Eggplant","Eggshell","Emerald","Fuchsia","Gold","Goldenrod","Gray","Green","Grey","Indigo","Ivory","Jade","Khaki","Lavender","Lemon","Lilac","Lime","Magenta","Mahogany","Maroon","Mauve","Mustard","Ocher","Olive","Orange","Orchid","Peach","Periwinkle","Persimmon","Pewter","Phlox","Pink","Puce","Pumpkin","Purple","Red","Rose","Ruby","Russet","Saffron","Salmon","Sapphire","Scarlet","Sepia","Shamrock","Sienna","Silver","Skobeloff","Slate","Tan","Tangerine","Taupe","Teal","Terracotta","Thistle","Topaz","Turquoise","Ultramarine","Umber","Vermilion","Violet","Viridian","Wheat","White","Wisteria","Yellow"],q=["#FFBF00","#9F2B68","#9966cc","#FBCEB1","#00FFFF","#00FFBF","#E87722","#007FFF","#f5f5dc","#000000","#0000FF","#CD7F32","#A52A2A","#97233F","#960018","#ACE1AF","#DE3163","#2a52be","#36454F","#dfff00","#7B3F00","#D2691E","#B87333","#e50d0e","#FF7F50","#FFFDD0","#DC143C","#00FFFF","#6F8FAF","#555D50","#C2B280","#483248","#F0EAD6","#50C878","#FF00FF","#FFD700","#daa520","#808080","#00FF00","#808080","#4B0082","#FFFFF0","#00A36C","#F0E68C","#E6E6FA","#fff44f","#C8A2C8","#BFFF00","#FF00FF","#C04000","#800000","#e0b0ff","#FFDB58","#CC7722","#808000","#FFA500","#da70d6","#FFE5B4","#CCCCFF","#EC5800","#E9EAEC","#df00ff","#FFC0CB","#CC8899","#ff7518","#6a0dad","#FF0000","#FF007F","#E0115F","#80461B","#F4C430","#fa8072","#0f52ba","#FF2400","#704214","#009E60","#A0522D","#C0C0C0","#007474","#C0C2C9","#D2B48C","#F28500","#483C32","#008080","#e2725b","#D8BFD8","#ffc87c","#30D5C8","#4166f5","#826644","#E34234","#8F00FF","#40826D","#f5deb3","#fcfcfc","#BDB5D5","#FFFF00"],ie=["Blazing","Fiery","Scorching","Flaming","Burning","Ember","Infernal","Searing","Ignited","Torch","Icy","Frosty","Glacial","Chilly","Aqueous","Marine","Tidal","Oceanic","Dewy","Misty","Breezy","Windy","Gusty","Aerial","Zephyr","Stormy","Whirling","Drafty","Tempest","Cyclonic","Rocky","Stony","Earthen","Muddy","Clay","Sandy","Pebble","Craggy","Rugged","Boulder"],pe=["#FF0000","#FF3300","#FF5500","#FF7700","#FF9900","#FFBB00","#FFDD00","#FFEE00","#FFCC00","#FFAA00","#00FFFF","#00E0E0","#00C0C0","#00A0A0","#008080","#006060","#004040","#002020","#00B7EB","#00CED1","#87CEEB","#ADD8E6","#B0E0E6","#87CEFA","#B0C4DE","#A1CAF1","#89CFF0","#73C2FB","#5F9EA0","#4682B4","#00FF00","#32CD32","#228B22","#006400","#008000","#2E8B57","#3CB371","#66CDAA","#8FBC8F","#20B2AA"],se=["Neon","Glow","Flux","Pulse","Spark"],Ce=["#FF00FF","#00FF00","#FFFF00","#FF4444","#00FFFF"],ce=["Stellar","Nebula","Cosmo","Astral","Nova"],Fe=["#4B0082","#800080","#000033","#483D8B","#9400D3"],W=["Jelly","Star","Moon","Crystal","Plasma"],V=["🪼","⭐","🌙","🔮","⚡️"],S=["Ant","Badger","Bat","Bear","Beaver","Beetle","Bird","Bison","Blowfish","Boar","Buffalo","Bug","Butterfly","Camel","Cat","Chicken","Chipmunk","Roach","Cow","Cow","Crab","Cricket","Crocodile","Deer","Dodo","Dog","Dolphin","Dove","Dragon","Duck","Eagle","Elephant","Fish","Flamingo","Fly","Fox","Frog","Giraffe","Goat","Gorilla","Hamster","Hedgehog","Hippopotamus","Honeybee","HoneyBadger","Horse","Kangaroo","Koala","Ladybug","Leopard","Lion","Lizard","Llama","Lobster","Mammoth","Microbe","Monkey","Mosquito","Mouse","Octopus","Orangutan","Otter","Owl","Ox","Panda","Parrot","Peacock","Penguin","Pig","Polar Bear","Poodle","Rabbit","Raccoon","Ram","Rat","Rhinoceros","Rock","Sauropod","Scorpion","Seal","Shark","Shrimp","Skunk","Sloth","Snail","Snake","Spider","Squid","Swan","Tiger","T-Rex","Turkey","Turtle","Unicorn","Whale","Wolf","Worm","Zebra"],A=["🐜","🦡","🦇","🐻","🦫","🪲","🐦","🦬","🐡","🐗","🐃","🐛","🦋","🐫","🐈","🐔","🐿️","🪳","🐄","🐮","🦀","🦗","🐊","🦌","🦤","🐕","🐬","🕊️","🐉","🦆","🦅","🐘","🐟","🦩","🪰","🦊","🐸","🦒","🐐","🦍","🐹","🦔","🦛","🐝","🍯🦡","🐎","🦘","🐨","🐞","🐆","🦁","🦎","🦙","🦞","🦣","🦠","🐒","🦟","🐁","🐙","🦧","🦦","🦉","🐂","🐼","🦜","🦚","🐧","🐖","🐻‍❄️","🐩","🐇","🦝","🐏","🐀","🦏","🪨","🦕","🦂","🦭","🦈","🦐","🦨","🦥","🐌","🐍","🕷️","🦑","🦢","🐅","🦖","🦃","🐢","🦄","🐋","🐺","🪱","🦓"],U=["Unicorn","Dragon","Phoenix","Dinosaur","Mermaid"],_=["🦄","🐉","🐦‍🔥","🦖","🧜"];let s=null;function Be(){const e=[...D,...ie,...se,...ce],t=[...w,...re,...le,...ae],o=[...S,...U],n=e[Math.floor(Math.random()*e.length)].toLowerCase(),l=t[Math.floor(Math.random()*t.length)].toLowerCase(),a=o[Math.floor(Math.random()*o.length)].toLowerCase();return`${n}-${l}-${a}`}ye(he,async e=>{if(e){s=e.uid,console.log("User is logged in on name-picker:",s);try{const t=await te(B(E,`users/${s}`));if(t.exists()){const o=t.val();if(o.username&&o.stage&&o.stage!=="name-picker"&&o.stage!=="collect_preferences"){console.log(`User ${s} has existing Woobie name and is past name-picking (stage: ${o.stage}). Redirecting to resume...`),window.location.href="/resume.html";return}}}catch(t){console.error("Error checking existing user stage in name-picker:",t)}document.getElementById("confirm")&&(document.getElementById("confirm").disabled=!1),document.getElementById("reroll")&&(document.getElementById("reroll").disabled=!1)}else console.log("No user logged in on name-picker. Redirecting to login."),window.location.href="/auth/login.html"});const K=document.querySelectorAll("[data-mode]"),y=document.getElementById("name-options"),f=document.getElementById("selected-name"),T=document.getElementById("reroll"),x=document.getElementById("confirm"),v=document.createElement("button");v.textContent="📜 Show Saved Options";v.className="woobie-button";y&&y.parentElement&&y.parentElement.appendChild(v);const p=document.createElement("div");p.style.marginBottom="1rem";p.style.color="#33ff33";p.id="roll-counter";y&&y.parentElement&&y.parentElement.insertBefore(p,y);let c=localStorage.getItem("woobieModePref")||"normal",Y=[],m=null,u=JSON.parse(localStorage.getItem("woobieSavedSets")||"[]"),h=parseInt(localStorage.getItem("woobieRerollCount")||"0");const $=9;let I=!1;console.log("[Name-Picker] Initial state:",{rerollCount:h,savedSetsLength:u.length,rerollsRemaining:$-h});x&&(x.disabled=!0);T&&(T.disabled=!0);function P(){localStorage.setItem("woobieSavedSets",JSON.stringify(u)),localStorage.setItem("woobieRerollCount",h.toString()),localStorage.setItem("woobieModePref",c),p&&(p.textContent=`Rerolls remaining: ${$-h}`,p.classList.add("flash-roll"),setTimeout(()=>p.classList.remove("flash-roll"),400))}function Ee(e){if(!e||typeof e!="string"||e.charAt(0)!=="#")return!1;const t=parseInt(e.slice(1),16),o=t>>16&255,n=t>>8&255,l=t&255;return .299*o+.587*n+.114*l<60}function H(){let e,t,o,n,l;switch(c){case"prismatic":e=[...w,...re],t=ie,o=pe,n=[...S,...U],l=[...A,..._];break;case"neon":e=[...w,...le],t=[...D,...se],o=[...q,...Ce],n=[...S,...U],l=[...A,..._];break;case"cosmic":e=[...w,...ae],t=[...D,...ce],o=[...q,...Fe],n=S.map(r=>W[Math.floor(Math.random()*W.length)]+r),l=A.map(r=>V[Math.floor(Math.random()*V.length)]+r);break;default:e=w,t=D,o=q,n=S,l=A}const a=[],C=new Set;let d=100;for(;a.length<3&&d>0;){const r=e[Math.floor(Math.random()*e.length)],i=Math.floor(Math.random()*t.length),M=t[i],g=o[i],F=Math.floor(Math.random()*n.length),me=n[F],ue=l[F],N=`${r} ${M} ${me}`;if(!C.has(N)){C.add(N);const fe=g,ge=c==="normal"&&Ee(g)?"#00ff00":"#000000";a.push({label:N,emoji:ue,fg:fe,bg:ge,mode:c})}d--}return d===0&&console.warn("Could not generate 3 unique names."),a}function k(e=null,t=!1){if(!y){console.error("nameOptions element not found for rendering names.");return}y.innerHTML="",Y=e||H(),Y.forEach(o=>{const n=document.createElement("button"),l=t?o.mode:c;n.className=`woobie-button name-button woobie-${l}`,l==="cosmic"&&n.classList.add("cosmic-pulse"),n.innerHTML=`<strong>${o.label} ${o.emoji}</strong>`,l==="normal"?(n.style.backgroundColor=o.bg,n.style.color=o.fg):o.bg!=="#000000"&&(n.style.backgroundColor=o.bg),m&&m.label===o.label&&m.emoji===o.emoji&&n.classList.add("selected"),n.onclick=()=>{m=o,f&&(f.innerHTML=`You picked: <strong>${o.label} ${o.emoji}</strong>`,f.className=`woobie-${l}`),document.querySelectorAll(".name-button").forEach(a=>a.classList.remove("selected")),n.classList.add("selected")},y.appendChild(n)})}T&&(T.onclick=()=>{if(console.log("[Reroll Button] Clicked. Current rerollCount:",h,"Max:",$),I){console.log("[Reroll Button] BLOCKED - cooldown active");return}if(h>=$){console.log("[Reroll Button] BLOCKED - max rerolls reached"),alert("You've reached the max rerolls. Pick from your saved ones or confirm a name.");return}I=!0,setTimeout(()=>{I=!1},600);const e=H();u.length>=20&&u.shift(),u.push(e),h++,console.log("[Reroll Button] Incremented rerollCount to:",h),P(),k(e),m=null,f&&(f.innerHTML="")});v&&(v.onclick=()=>{const e=document.createElement("div");e.tabIndex=-1,e.style.cssText="position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.95); z-index:9999; overflow-y:auto; padding:2rem; display:flex; flex-direction:column; align-items:center; justify-content:center;",e.innerHTML='<div style="background:#121212; border:1px solid #33ff33; padding:2rem; border-radius:5px; max-height:80vh; overflow-y:auto; width: 90%; max-width: 600px;"><h2 style="color:#33ff33; text-align:center;">Saved Sets</h2><div id="modal-sets-container" style="max-height: 60vh; overflow-y: auto;"></div><button id="close-saved-modal" class="woobie-button" style="margin-top:1rem;">❌ Close</button></div>',document.body.appendChild(e);const t=document.getElementById("modal-sets-container");u.length===0&&t?t.innerHTML="<p style='color:#999;'>No sets saved yet. Reroll to save name options!</p>":t&&u.forEach((n,l)=>{var d;const a=document.createElement("div");a.style.margin="1rem 0",a.style.border="1px dashed #33ff33",a.style.padding="1rem";const C=((d=n[0])==null?void 0:d.mode)||c;a.innerHTML=`<strong style="color:#33ff33">Set #${l+1} (Mode: ${C})</strong>`,n.forEach(r=>{const i=document.createElement("button");i.className=`woobie-button name-button woobie-${r.mode}`,r.mode==="cosmic"&&i.classList.add("cosmic-pulse"),i.innerHTML=`<strong>${r.label} ${r.emoji}</strong>`,r.mode==="normal"?(i.style.backgroundColor=r.bg,i.style.color=r.fg):r.bg!=="#000000"&&(i.style.backgroundColor=r.bg),i.style.margin="0.25rem",m&&m.label===r.label&&m.emoji===r.emoji&&i.classList.add("selected"),i.onclick=()=>{m=r,c=r.mode,document.body.className=`${c}-mode`,f&&(f.innerHTML=`You picked: <strong>${r.label} ${r.emoji}</strong>`,f.className=`woobie-${r.mode}`),document.querySelectorAll(".name-button").forEach(g=>g.classList.remove("selected")),k(n,!0),(y?y.querySelectorAll(".name-button"):[]).forEach(g=>{g.innerHTML.includes(r.label)&&g.innerHTML.includes(r.emoji)&&g.classList.add("selected")}),document.body.removeChild(e)},a.appendChild(i)}),t.appendChild(a)});const o=document.getElementById("close-saved-modal");o&&(o.onclick=()=>document.body.removeChild(e)),e.focus(),e.addEventListener("keydown",n=>{n.key==="Escape"&&document.body.removeChild(e)})});K&&K.forEach(e=>{e.onclick=()=>{const t=e.dataset.mode;if(console.log("[Mode Switch] Clicked mode:",t,"Current mode:",c),t===c){console.log("[Mode Switch] Same mode clicked, ignoring");return}I=!0,setTimeout(()=>{I=!1},600),c=t,document.body.className=`${c}-mode`,f&&(f.className=`woobie-${c}`);const o=H();u.length>=20&&u.shift(),u.push(o),console.log("[Mode Switch] Generated new set. rerollCount still:",h,"savedSets.length:",u.length),P(),k(o),m=null,f&&(f.innerHTML="")}});if(document.getElementById("name-options"))if(u.length===0){const e=H();e.length>0&&(u.unshift(e),P(),k(e))}else{const e=u[u.length-1];e&&e[0]&&(c=e[0].mode,document.body.className=`${c}-mode`,f&&(f.className=`woobie-${c}`)),P(),k(e,!0)}let b=null;x&&(x.onclick=async()=>{if(!m){alert("Please pick a name.");return}if(!s){alert("Authentication error. Please ensure you are logged in and refresh.");return}b={woobieName:`${m.label} ${m.emoji}`,emoji:m.emoji,mode:m.mode},document.getElementById("name-options").style.display="none",document.getElementById("reroll").style.display="none",document.getElementById("confirm").style.display="none",document.getElementById("selected-name").style.display="none";const e=document.getElementById("mode-buttons");e&&(e.style.display="none"),document.getElementById("primary-action").style.display="block",document.getElementById("referral-section").style.display="block"});const de=document.createElement("style");de.innerHTML=`
  .flash-roll { animation: flashdown 0.4s ease-in-out; }
  @keyframes flashdown { 0% { transform: scale(1.2); color: #00ffff; } 100% { transform: scale(1); color: #33ff33; } }
`;document.head&&document.head.appendChild(de);async function G(e=null,t="normal"){if(!b||!s)return;const{woobieName:o,emoji:n,mode:l}=b;if(localStorage.setItem("woobieUsername",o),localStorage.setItem("woobieEmoji",n),localStorage.setItem("woobieMode",l),localStorage.setItem("woobieUID",s),localStorage.removeItem("woobieSavedSets"),localStorage.removeItem("woobieRerollCount"),localStorage.removeItem("woobieModePref"),e){let d=null;t==="claiming"&&(d=`m-${Date.now()}-${Math.floor(Math.random()*1e3)}`,localStorage.setItem("woobieMatchID",d));const r=B(E,`users/${s}`),i={username:o,stage:"waiting_in_queue",referralCodeID:e,referralMode:t,currentMatch:{username:o,stage:"waiting_in_queue"}};d&&(i.currentMatch.matchID=d);try{await z(r,i),console.log(`User ${s} with referral code proceeding directly to queue`)}catch(F){console.error("Error updating user profile:",F),alert("Could not save your profile. Please try again.");return}const M=B(E,`queue/${s}`),g={userUID:s,woobieName:o,mode:l,emoji:n,timestamp:Date.now(),referralCodeID:e,referralMode:t};d&&(g.potentialMatchIDForUser=d),t==="waiting"?g.waitingForReferral=!0:t==="claiming"&&(g.claimingReferral=!0);try{await ne(M,g),console.log(`User ${s} added to queue with referral code`)}catch(F){console.error("Error adding to queue:",F),alert("Could not add you to queue. Please try again.");return}window.location.href="/interests-dealbreakers/waiting.html";return}const a=B(E,`users/${s}`),C={username:o,stage:"interests-dealbreakers",currentMatch:{username:o,stage:"interests-dealbreakers"}};try{await z(a,C),console.log(`User profile updated for ${s}. WoobieName: ${o}. Next stage: interests-dealbreakers.`)}catch(d){console.error("Error updating user profile:",d),alert("Could not save your name choice. Please try again.");return}window.location.href="/interests-dealbreakers/index.html"}const J=document.getElementById("generate-code-btn");J&&(J.onclick=async()=>{const e=Be(),t=Date.now()+7*24*60*60*1e3,o=B(E,`referralCodes/${e}`);try{await ne(o,{code:e,createdBy:s,createdAt:Date.now(),username:b.woobieName,mode:b.mode,emoji:b.emoji,used:!1,expiresAt:t}),document.getElementById("referral-choice").style.display="none",document.getElementById("generated-code").textContent=e,document.getElementById("code-generated-view").style.display="block"}catch(n){console.error("Error creating referral code:",n),alert("Failed to generate code. Please try again.")}});const L=document.getElementById("copy-code-btn");L&&(L.onclick=()=>{const e=document.getElementById("generated-code").textContent;navigator.clipboard.writeText(e).then(()=>{L.textContent="✅ Copied!",setTimeout(()=>{L.textContent="📋 Copy Code"},2e3)})});const j=document.getElementById("proceed-with-code-btn");j&&(j.onclick=async()=>{const e=document.getElementById("generated-code").textContent;await G(e,"waiting")});const Z=document.getElementById("enter-code-btn");Z&&(Z.onclick=()=>{document.getElementById("referral-choice").style.display="none",document.getElementById("code-entry-view").style.display="block"});const Q=document.getElementById("back-to-choice-btn");Q&&(Q.onclick=()=>{document.getElementById("code-entry-view").style.display="none",document.getElementById("referral-choice").style.display="flex",document.getElementById("referral-code-input").value="",document.getElementById("code-validation-msg").innerHTML=""});let R=null;const X=document.getElementById("validate-code-btn");X&&(X.onclick=async()=>{const e=document.getElementById("referral-code-input").value.trim().toLowerCase(),t=document.getElementById("code-validation-msg");if(!e){t.innerHTML='<p style="color:#ff6666;">Please enter a code</p>';return}const o=B(E,`referralCodes/${e}`);try{const n=await te(o);if(!n.exists()){t.innerHTML='<p style="color:#ff6666;">❌ Invalid code</p>';return}const l=n.val();if(l.used){t.innerHTML='<p style="color:#ff6666;">❌ Code already used</p>';return}if(l.createdBy===s){t.innerHTML=`<p style="color:#ff6666;">❌ You can't use your own code</p>`;return}if(Date.now()>l.expiresAt){t.innerHTML='<p style="color:#ff6666;">❌ Code expired</p>';return}R={code:e,...l},t.innerHTML='<p style="color:#00ffff;">✅ Valid code!</p>',document.getElementById("code-entry-view").style.display="none",document.getElementById("match-preview").innerHTML=`
        <p style="color:#33ff33; font-size:1.1rem;">${l.username} invited you!</p>
      `,document.getElementById("code-confirmed-view").style.display="block"}catch(n){console.error("Error validating code:",n),t.innerHTML='<p style="color:#ff6666;">Error validating code</p>'}});const O=document.getElementById("confirm-referral-match-btn");O&&(O.onclick=async()=>{R&&await G(R.code,"claiming")});const ee=document.getElementById("cancel-referral-btn");ee&&(ee.onclick=()=>{document.getElementById("code-confirmed-view").style.display="none",document.getElementById("referral-choice").style.display="flex",document.getElementById("referral-code-input").value="",document.getElementById("code-validation-msg").innerHTML="",R=null});const oe=document.getElementById("skip-referral-btn");oe&&(oe.onclick=()=>{G()});

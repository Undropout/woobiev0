import{o as b,g as n,r as s,d as l,a as u}from"./firebase-config-CQBF9bbN.js";/* empty css              */const r=document.getElementById("status"),d={"name-picker":"/name-picker/index.html",preferences_pending:"/preferences.html","interests-dealbreakers":"/interests-dealbreakers/index.html",bio:"/bio/index.html",waiting_in_queue:"/interests-dealbreakers/waiting.html",tier1a:"/tier1a/index.html","tier1a-answers-submitted":"/tier1a/index.html","tier1a-bios-revealed":"/tier1a/reveal-bios.html","tier1a-vote-no":"/goodbye.html",tier1b:"/tier1b/index.html","tier1b-complete":"/tier1b/index.html","goodbye-tier1b":"/goodbye.html",tier2:"/tier2/index.html","tier2-answers-submitted":"/tier2/send.html","tier2-send":"/tier2/send.html","tier2-reward-sent":"/tier2/send.html","tier2-complete":"/tier2/send.html","tier2-reveal":"/tier2/reveal.html",tier3:"/tier3/index.html","goodbye-tier3":"/goodbye.html",chatroom:"/chat/index.html",goodbye:"/goodbye.html"};b(u,async i=>{if(!i){r.textContent="Not logged in. Redirecting to login...",setTimeout(()=>window.location.href="/auth/login.html",1500);return}try{const a=(await n(s(l,`users/${i.uid}`))).val();if(!a||!a.stage){r.textContent="Setting up your Woobie profile... Redirecting to name picker.",setTimeout(()=>window.location.href="/name-picker/index.html",2e3);return}const e=a.currentMatch;if(!e||!e.matchID||!e.username){const c=a.stage||"name-picker",h=d[c]||"/name-picker/index.html";r.textContent="Welcome! Continuing to your next step...",localStorage.setItem("woobieUID",i.uid),localStorage.removeItem("woobieMatchID"),localStorage.removeItem("woobieUsername"),localStorage.removeItem("tier2Answers"),setTimeout(()=>window.location.href=h,2e3);return}const t=e.stage,g=d[t]||"/name-picker/index.html";if(localStorage.setItem("woobieMatchID",e.matchID),localStorage.setItem("woobieUsername",e.username),localStorage.setItem("woobieUID",i.uid),t!=="waiting_in_queue"&&t!=="name-picker"&&t!=="preferences_pending"&&t!=="interests-dealbreakers"&&t!=="bio")if((await n(s(l,`matches/${e.matchID}/users/${i.uid}`))).exists()){const o=(await n(s(l,`matches/${e.matchID}/profiles/${i.uid}`))).val();o&&(o.bio&&localStorage.setItem("woobieBio",o.bio),o.interests&&localStorage.setItem("woobieInterests",JSON.stringify(o.interests)),o.dealbreakers&&localStorage.setItem("woobieDealbreakers",JSON.stringify(o.dealbreakers)))}else t!=="waiting_in_queue"&&console.warn(`User ${i.uid} stage is ${t} for match ${e.matchID}, but they are not in matches/.../users. This might be a data consistency issue or stale stage.`);r.textContent=`Resuming from ${t}...`,setTimeout(()=>window.location.href=g,1500)}catch(m){console.error("Error loading session from /resume.html:",m),r.innerHTML='Error loading session. <a href="/auth/login.html" style="color:#00ffff; text-decoration:underline;">Click here to log in again</a>.',r.style.color="#ff6666"}});

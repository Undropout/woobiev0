import{o as X,g as K,r as p,d as b,a as O,u as S,b as ee,i as G}from"./firebase-config-CQBF9bbN.js";/* empty css              */import"./logout-BHqC0Y9t.js";import"./feedback-CLnNHjql.js";const E=["Vibrant","Lazy","Cheerful","Quirky","Gentle","Bold","Shy","Clever"],oe=["Radiant","Shimmering","Iridescent","Gleaming","Prismatic"],te=["Glowing","Electric","Buzzing","Pulsing","Flashing"],ne=["Stellar","Astral","Luminous","Celestial","Galactic"],A=["Amber","Amaranth","Amethyst","Apricot","Aqua","Aquamarine","Auburn","Azure","Beige","Black","Blue","Bronze","Brown","Cardinal","Carmine","Celadon","Cerise","Cerulean","Charcoal","Chartreuse","Chocolate","Cinnamon","Copper","Coquelicot","Coral","Cream","Crimson","Cyan","Denim","Ebony","Ecru","Eggplant","Eggshell","Emerald","Fuchsia","Gold","Goldenrod","Gray","Green","Grey","Indigo","Ivory","Jade","Khaki","Lavender","Lemon","Lilac","Lime","Magenta","Mahogany","Maroon","Mauve","Mustard","Ocher","Olive","Orange","Orchid","Peach","Periwinkle","Persimmon","Pewter","Phlox","Pink","Puce","Pumpkin","Purple","Red","Rose","Ruby","Russet","Saffron","Salmon","Sapphire","Scarlet","Sepia","Shamrock","Sienna","Silver","Skobeloff","Slate","Tan","Tangerine","Taupe","Teal","Terracotta","Thistle","Topaz","Turquoise","Ultramarine","Umber","Vermilion","Violet","Viridian","Wheat","White","Wisteria","Yellow"],R=["#FFBF00","#9F2B68","#9966cc","#FBCEB1","#00FFFF","#00FFBF","#E87722","#007FFF","#f5f5dc","#000000","#0000FF","#CD7F32","#A52A2A","#97233F","#960018","#ACE1AF","#DE3163","#2a52be","#36454F","#dfff00","#7B3F00","#D2691E","#B87333","#e50d0e","#FF7F50","#FFFDD0","#DC143C","#00FFFF","#6F8FAF","#555D50","#C2B280","#483248","#F0EAD6","#50C878","#FF00FF","#FFD700","#daa520","#808080","#00FF00","#808080","#4B0082","#FFFFF0","#00A36C","#F0E68C","#E6E6FA","#fff44f","#C8A2C8","#BFFF00","#FF00FF","#C04000","#800000","#e0b0ff","#FFDB58","#CC7722","#808000","#FFA500","#da70d6","#FFE5B4","#CCCCFF","#EC5800","#E9EAEC","#df00ff","#FFC0CB","#CC8899","#ff7518","#6a0dad","#FF0000","#FF007F","#E0115F","#80461B","#F4C430","#fa8072","#0f52ba","#FF2400","#704214","#009E60","#A0522D","#C0C0C0","#007474","#C0C2C9","#D2B48C","#F28500","#483C32","#008080","#e2725b","#D8BFD8","#ffc87c","#30D5C8","#4166f5","#826644","#E34234","#8F00FF","#40826D","#f5deb3","#fcfcfc","#BDB5D5","#FFFF00"],re=["Blazing","Fiery","Scorching","Flaming","Burning","Ember","Infernal","Searing","Ignited","Torch","Icy","Frosty","Glacial","Chilly","Aqueous","Marine","Tidal","Oceanic","Dewy","Misty","Breezy","Windy","Gusty","Aerial","Zephyr","Stormy","Whirling","Drafty","Tempest","Cyclonic","Rocky","Stony","Earthen","Muddy","Clay","Sandy","Pebble","Craggy","Rugged","Boulder"],ae=["#FF0000","#FF3300","#FF5500","#FF7700","#FF9900","#FFBB00","#FFDD00","#FFEE00","#FFCC00","#FFAA00","#00FFFF","#00E0E0","#00C0C0","#00A0A0","#008080","#006060","#004040","#002020","#00B7EB","#00CED1","#87CEEB","#ADD8E6","#B0E0E6","#87CEFA","#B0C4DE","#A1CAF1","#89CFF0","#73C2FB","#5F9EA0","#4682B4","#00FF00","#32CD32","#228B22","#006400","#008000","#2E8B57","#3CB371","#66CDAA","#8FBC8F","#20B2AA"],le=["Neon","Glow","Flux","Pulse","Spark"],se=["#FF00FF","#00FF00","#FFFF00","#FF4444","#00FFFF"],ie=["Stellar","Nebula","Cosmo","Astral","Nova"],ce=["#4B0082","#800080","#000033","#483D8B","#9400D3"],U=["Jelly","Star","Moon","Crystal","Plasma"],q=["🪼","⭐","🌙","🔮","⚡️"],w=["Ant","Badger","Bat","Bear","Beaver","Beetle","Bird","Bison","Blowfish","Boar","Buffalo","Bug","Butterfly","Camel","Cat","Chicken","Chipmunk","Roach","Cow","Cow","Crab","Cricket","Crocodile","Deer","Dodo","Dog","Dolphin","Dove","Dragon","Duck","Eagle","Elephant","Fish","Flamingo","Fly","Fox","Frog","Giraffe","Goat","Gorilla","Hamster","Hedgehog","Hippopotamus","Honeybee","HoneyBadger","Horse","Kangaroo","Koala","Ladybug","Leopard","Lion","Lizard","Llama","Lobster","Mammoth","Microbe","Monkey","Mosquito","Mouse","Octopus","Orangutan","Otter","Owl","Ox","Panda","Parrot","Peacock","Penguin","Pig","Polar Bear","Poodle","Rabbit","Raccoon","Ram","Rat","Rhinoceros","Rock","Sauropod","Scorpion","Seal","Shark","Shrimp","Skunk","Sloth","Snail","Snake","Spider","Squid","Swan","Tiger","T-Rex","Turkey","Turtle","Unicorn","Whale","Wolf","Worm","Zebra"],M=["🐜","🦡","🦇","🐻","🦫","🪲","🐦","🦬","🐡","🐗","🐃","🐛","🦋","🐫","🐈","🐔","🐿️","🪳","🐄","🐮","🦀","🦗","🐊","🦌","🦤","🐕","🐬","🕊️","🐉","🦆","🦅","🐘","🐟","🦩","🪰","🦊","🐸","🦒","🐐","🦍","🐹","🦔","🦛","🐝","🍯🦡","🐎","🦘","🐨","🐞","🐆","🦁","🦎","🦙","🦞","🦣","🦠","🐒","🦟","🐁","🐙","🦧","🦦","🦉","🐂","🐼","🦜","🦚","🐧","🐖","🐻‍❄️","🐩","🐇","🦝","🐏","🐀","🦏","🪨","🦕","🦂","🦭","🦈","🦐","🦨","🦥","🐌","🐍","🕷️","🦑","🦢","🐅","🦖","🦃","🐢","🦄","🐋","🐺","🪱","🦓"],z=["Unicorn","Dragon","Phoenix","Dinosaur","Mermaid"],W=["🦄","🐉","🐦‍🔥","🦖","🧜"];typeof window<"u"&&(window.namePartsModule={baseColors:A,baseAdjectives:E,baseAnimals:w});let f=null;X(O,async e=>{if(e){f=e.uid,console.log("User is logged in on name-picker:",f);try{const o=await K(p(b,`users/${f}`));if(o.exists()){const t=o.val();if(t.username&&t.stage&&t.stage!=="name-picker"&&t.stage!=="collect_preferences"){console.log(`User ${f} has existing Woobie name and is past name-picking (stage: ${t.stage}). Redirecting to resume...`),window.location.href="/resume.html";return}}}catch(o){console.error("Error checking existing user stage in name-picker:",o)}document.getElementById("confirm")&&(document.getElementById("confirm").disabled=!1),document.getElementById("reroll")&&(document.getElementById("reroll").disabled=!1)}else console.log("No user logged in on name-picker. Redirecting to login."),window.location.href="/auth/login.html"});const V=document.querySelectorAll("[data-mode]"),y=document.getElementById("name-options"),g=document.getElementById("selected-name"),x=document.getElementById("reroll"),D=document.getElementById("confirm"),v=document.createElement("button");v.textContent="📜 Show Saved Options";v.className="woobie-button";y&&y.parentElement&&y.parentElement.appendChild(v);const B=document.createElement("div");B.style.marginBottom="1rem";B.style.color="#33ff33";B.id="roll-counter";y&&y.parentElement&&y.parentElement.insertBefore(B,y);let c=localStorage.getItem("woobieModePref")||"normal",Y=[],d=null,m=JSON.parse(localStorage.getItem("woobieSavedSets")||"[]"),C=parseInt(localStorage.getItem("woobieRerollCount")||"0");const L=9;let k=!1;console.log("[Name-Picker] Initial state:",{rerollCount:C,savedSetsLength:m.length,rerollsRemaining:L-C});D&&(D.disabled=!0);x&&(x.disabled=!0);function T(){localStorage.setItem("woobieSavedSets",JSON.stringify(m)),localStorage.setItem("woobieRerollCount",C.toString()),localStorage.setItem("woobieModePref",c),B&&(B.textContent=`Rerolls remaining: ${L-C}`,B.classList.add("flash-roll"),setTimeout(()=>B.classList.remove("flash-roll"),400))}function de(e){if(!e||typeof e!="string"||e.charAt(0)!=="#")return!1;const o=parseInt(e.slice(1),16),t=o>>16&255,n=o>>8&255,s=o&255;return .299*t+.587*n+.114*s<60}function P(){let e,o,t,n,s;switch(c){case"prismatic":e=[...E,...oe],o=re,t=ae,n=[...w,...z],s=[...M,...W];break;case"neon":e=[...E,...te],o=[...A,...le],t=[...R,...se],n=[...w,...z],s=[...M,...W];break;case"cosmic":e=[...E,...ne],o=[...A,...ie],t=[...R,...ce],n=w.map(r=>U[Math.floor(Math.random()*U.length)]+r),s=M.map(r=>q[Math.floor(Math.random()*q.length)]+r);break;default:e=E,o=A,t=R,n=w,s=M}const i=[],u=new Set;let a=100;for(;i.length<3&&a>0;){const r=e[Math.floor(Math.random()*e.length)],l=Math.floor(Math.random()*o.length),h=o[l],F=t[l],N=Math.floor(Math.random()*n.length),Z=n[N],_=s[N],$=`${r} ${h} ${Z}`;if(!u.has($)){u.add($);const j=F,Q=c==="normal"&&de(F)?"#00ff00":"#000000";i.push({label:$,emoji:_,fg:j,bg:Q,mode:c})}a--}return a===0&&console.warn("Could not generate 3 unique names."),i}function I(e=null,o=!1){if(!y){console.error("nameOptions element not found for rendering names.");return}y.innerHTML="",Y=e||P(),Y.forEach(t=>{const n=document.createElement("button"),s=o?t.mode:c;n.className=`woobie-button name-button woobie-${s}`,s==="cosmic"&&n.classList.add("cosmic-pulse"),n.innerHTML=`<strong>${t.label} ${t.emoji}</strong>`,s==="normal"?(n.style.backgroundColor=t.bg,n.style.color=t.fg):t.bg!=="#000000"&&(n.style.backgroundColor=t.bg),d&&d.label===t.label&&d.emoji===t.emoji&&n.classList.add("selected"),n.onclick=()=>{d=t,g&&(g.innerHTML=`You picked: <strong>${t.label} ${t.emoji}</strong>`,g.className=`woobie-${s}`),document.querySelectorAll(".name-button").forEach(i=>i.classList.remove("selected")),n.classList.add("selected")},y.appendChild(n)})}x&&(x.onclick=()=>{if(console.log("[Reroll Button] Clicked. Current rerollCount:",C,"Max:",L),k){console.log("[Reroll Button] BLOCKED - cooldown active");return}if(C>=L){console.log("[Reroll Button] BLOCKED - max rerolls reached"),alert("You've reached the max rerolls. Pick from your saved ones or confirm a name.");return}k=!0,setTimeout(()=>{k=!1},600);const e=P();m.length>=20&&m.shift(),m.push(e),C++,console.log("[Reroll Button] Incremented rerollCount to:",C),T(),I(e),d=null,g&&(g.innerHTML="")});v&&(v.onclick=()=>{const e=document.createElement("div");e.tabIndex=-1,e.style.cssText="position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.95); z-index:9999; overflow-y:auto; padding:2rem; display:flex; flex-direction:column; align-items:center; justify-content:center;",e.innerHTML='<div style="background:#121212; border:1px solid #33ff33; padding:2rem; border-radius:5px; max-height:80vh; overflow-y:auto; width: 90%; max-width: 600px;"><h2 style="color:#33ff33; text-align:center;">Saved Sets</h2><div id="modal-sets-container" style="max-height: 60vh; overflow-y: auto;"></div><button id="close-saved-modal" class="woobie-button" style="margin-top:1rem;">❌ Close</button></div>',document.body.appendChild(e);const o=document.getElementById("modal-sets-container");m.length===0&&o?o.innerHTML="<p style='color:#999;'>No sets saved yet. Reroll to save name options!</p>":o&&m.forEach((n,s)=>{var a;const i=document.createElement("div");i.style.margin="1rem 0",i.style.border="1px dashed #33ff33",i.style.padding="1rem";const u=((a=n[0])==null?void 0:a.mode)||c;i.innerHTML=`<strong style="color:#33ff33">Set #${s+1} (Mode: ${u})</strong>`,n.forEach(r=>{const l=document.createElement("button");l.className=`woobie-button name-button woobie-${r.mode}`,r.mode==="cosmic"&&l.classList.add("cosmic-pulse"),l.innerHTML=`<strong>${r.label} ${r.emoji}</strong>`,r.mode==="normal"?(l.style.backgroundColor=r.bg,l.style.color=r.fg):r.bg!=="#000000"&&(l.style.backgroundColor=r.bg),l.style.margin="0.25rem",d&&d.label===r.label&&d.emoji===r.emoji&&l.classList.add("selected"),l.onclick=()=>{d=r,c=r.mode,document.body.className=`${c}-mode`,g&&(g.innerHTML=`You picked: <strong>${r.label} ${r.emoji}</strong>`,g.className=`woobie-${r.mode}`),document.querySelectorAll(".name-button").forEach(F=>F.classList.remove("selected")),I(n,!0),(y?y.querySelectorAll(".name-button"):[]).forEach(F=>{F.innerHTML.includes(r.label)&&F.innerHTML.includes(r.emoji)&&F.classList.add("selected")}),document.body.removeChild(e)},i.appendChild(l)}),o.appendChild(i)});const t=document.getElementById("close-saved-modal");t&&(t.onclick=()=>document.body.removeChild(e)),e.focus(),e.addEventListener("keydown",n=>{n.key==="Escape"&&document.body.removeChild(e)})});V&&V.forEach(e=>{e.onclick=()=>{const o=e.dataset.mode;if(console.log("[Mode Switch] Clicked mode:",o,"Current mode:",c),o===c){console.log("[Mode Switch] Same mode clicked, ignoring");return}k=!0,setTimeout(()=>{k=!1},600),c=o,document.body.className=`${c}-mode`,g&&(g.className=`woobie-${c}`);const t=P();m.length>=20&&m.shift(),m.push(t),console.log("[Mode Switch] Generated new set. rerollCount still:",C,"savedSets.length:",m.length),T(),I(t),d=null,g&&(g.innerHTML="")}});if(document.getElementById("name-options"))if(m.length===0){const e=P();e.length>0&&(m.unshift(e),T(),I(e))}else{const e=m[m.length-1];e&&e[0]&&(c=e[0].mode,document.body.className=`${c}-mode`,g&&(g.className=`woobie-${c}`)),T(),I(e,!0)}if(D){D.onclick=async()=>{if(!d){alert("Please pick a name.");return}if(!f){alert("Authentication error. Please ensure you are logged in and refresh.");return}const o=`${d.label} ${d.emoji}`;localStorage.setItem("woobieUsername",o),localStorage.setItem("woobieEmoji",d.emoji),localStorage.setItem("woobieMode",d.mode),localStorage.setItem("woobieUID",f);const t=p(b,`users/${f}`);try{await S(t,{username:o,stage:"name-picker",currentMatch:{username:o,stage:"name-picker"}}),console.log(`User profile updated with name: ${o}`)}catch(n){console.error("Error saving username:",n),alert("Could not save your name choice. Please try again.");return}document.getElementById("confirm").style.display="none",document.getElementById("reroll").style.display="none",document.getElementById("continue-main-btn").style.display="block",document.getElementById("referral-section").style.display="block"};const e=document.getElementById("continue-main-btn");e&&(e.onclick=async()=>{await H()}),me()}function me(){const e=document.getElementById("generate-code-btn"),o=document.getElementById("enter-code-btn"),t=document.getElementById("copy-code-btn"),n=document.getElementById("proceed-with-code-btn"),s=document.getElementById("validate-code-btn"),i=document.getElementById("cancel-entry-btn");e&&(e.onclick=async()=>{const u=ue(),a=localStorage.getItem("woobieUsername"),r=localStorage.getItem("woobieMode"),l=localStorage.getItem("woobieEmoji");try{await ee(p(b,`referralCodes/${u}`),{code:u,createdBy:f,createdAt:G(),username:a,mode:r,emoji:l,used:!1,expiresAt:Date.now()+7*24*60*60*1e3}),await S(p(b,`users/${f}`),{referralCodeID:u,referralMode:"waiting"}),document.getElementById("generated-code").textContent=u,document.getElementById("code-result").style.display="block",e.style.display="none",o.style.display="none",console.log(`Generated referral code: ${u}`)}catch(h){console.error("Error generating referral code:",h),alert("Failed to generate code. Please try again.")}}),t&&(t.onclick=()=>{const u=document.getElementById("generated-code").textContent;navigator.clipboard.writeText(u).then(()=>{t.textContent="✅ Copied!",setTimeout(()=>t.textContent="📋 Copy Code",2e3)})}),n&&(n.onclick=async()=>{await H()}),o&&(o.onclick=()=>{document.getElementById("code-entry").style.display="block",e.style.display="none",o.style.display="none"}),s&&(s.onclick=async()=>{const u=document.getElementById("friend-code-input"),a=document.getElementById("validation-message"),r=u.value.trim().toLowerCase();if(!r){a.style.color="#ff6666",a.textContent="Please enter a code.";return}try{const l=await K(p(b,`referralCodes/${r}`));if(!l.exists()){a.style.color="#ff6666",a.textContent="❌ Invalid code.";return}const h=l.val();if(h.createdBy===f){a.style.color="#ff6666",a.textContent="❌ You cannot use your own code.";return}if(h.used){a.style.color="#ff6666",a.textContent="❌ This code has already been used.";return}if(Date.now()>h.expiresAt){a.style.color="#ff6666",a.textContent="❌ This code has expired.";return}a.style.color="#33ff33",a.textContent=`✅ Valid! You'll match with ${h.username}`,await S(p(b,`users/${f}`),{referralCodeID:r,referralMode:"claiming"}),await S(p(b,`referralCodes/${r}`),{usedBy:f,usedAt:G()}),setTimeout(async()=>{await H()},1500)}catch(l){console.error("Error validating code:",l),a.style.color="#ff6666",a.textContent="❌ Error validating code. Please try again."}}),i&&(i.onclick=()=>{document.getElementById("code-entry").style.display="none",document.getElementById("friend-code-input").value="",document.getElementById("validation-message").textContent="",e.style.display="inline-block",o.style.display="inline-block"})}function ue(){const{baseColors:e,baseAdjectives:o,baseAnimals:t}=window.namePartsModule,n=e[Math.floor(Math.random()*e.length)].toLowerCase(),s=o[Math.floor(Math.random()*o.length)].toLowerCase(),i=t[Math.floor(Math.random()*t.length)].toLowerCase();return`${n}-${s}-${i}`}async function H(){localStorage.removeItem("woobieSavedSets"),localStorage.removeItem("woobieRerollCount"),localStorage.removeItem("woobieModePref");const e=p(b,`users/${f}`);try{await S(e,{stage:"interests-dealbreakers","currentMatch/stage":"interests-dealbreakers"}),console.log("Proceeding to interests-dealbreakers stage")}catch(o){console.error("Error updating stage:",o)}window.location.href="/interests-dealbreakers/index.html"}const J=document.createElement("style");J.innerHTML=`
  .flash-roll { animation: flashdown 0.4s ease-in-out; }
  @keyframes flashdown { 0% { transform: scale(1.2); color: #00ffff; } 100% { transform: scale(1); color: #33ff33; } }
`;document.head&&document.head.appendChild(J);

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/preload-helper-DX5QSOJm.js","assets/firebase-config-DqIMhm9h.js"])))=>i.map(i=>d[i]);
import{a as E,r as u,d as m,b as I,u as y}from"./firebase-config-DqIMhm9h.js";/* empty css              */import{_ as x}from"./preload-helper-DX5QSOJm.js";import"./logout-C5vuDOMp.js";function C(t){return t.replace(new RegExp("(\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)","gu"),i=>`<span class="woobie-emoji">${i}</span>`)}document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector("h1");t.innerHTML=C(t.textContent);const i=document.getElementById("submit-bio");i.innerHTML='Submit <span class="woobie-emoji">â†’</span>'});const d=document.getElementById("bio-input"),S=document.getElementById("bio-count"),e=document.getElementById("bio-warning"),a=document.getElementById("submit-bio");d.addEventListener("input",()=>{const t=d.value.trim().split(/\s+/).filter(Boolean);S.textContent=`${t.length} / 250 words`,t.length>250?(e.textContent="Too many words! Please stay under 250.",a.disabled=!0):(e.textContent="",a.disabled=!1)});a.onclick=async()=>{const t=d.value.trim(),i=t.split(/\s+/).filter(Boolean),h=/(.)\1{20,}/.test(t);if(i.length>250||h){e.textContent="Please shorten your bio and avoid repeated characters.";return}const s=E.currentUser;if(!s){e.textContent="You're not logged in. Please log in again.";return}a.disabled=!0,e.textContent="Submitting...",e.style.color="#33ff33";try{let r=localStorage.getItem("woobieMatchID");if(!r){const{get:o}=await x(async()=>{const{get:w}=await import("./preload-helper-DX5QSOJm.js").then(p=>p.i);return{get:w}},__vite__mapDeps([0,1])),n=(await o(u(m,`users/${s.uid}/currentMatch`))).val();if(!n||!n.matchID){e.textContent="No match found. Please restart from the beginning.",e.style.color="#ff6666",a.disabled=!1;return}r=n.matchID,localStorage.setItem("woobieMatchID",r),n.username&&localStorage.setItem("woobieUsername",n.username)}localStorage.setItem("woobieBio",t);const f=u(m,`matches/${r}/bios/${s.uid}`),l=3;let c=0,b=null;for(;c<l;)try{await s.getIdToken(!0),await I(f,t);const o=u(m,`users/${s.uid}/currentMatch`);await y(o,{stage:"tier1a"}),window.location.href="/tier1a/index.html";return}catch(o){if(b=o,o.code==="PERMISSION_DENIED"&&c<l-1){const g=1e3*Math.pow(2,c);e.textContent=`Setting up permissions... (${c+1}/${l})`,await new Promise(n=>setTimeout(n,g)),c++}else throw o}throw b}catch(r){console.error("Error submitting bio:",r),e.textContent="Error submitting bio. Please try again.",e.style.color="#ff6666",a.disabled=!1}};
